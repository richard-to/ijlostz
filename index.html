<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="js/vendor/jquery.js"></script>
        <script src="js/vendor/underscore.js"></script>
        <style type="text/css">
            body {
                margin-top: 50px;
            }
            canvas {
                border: 5px solid #bbb;
                display: block;
                margin: auto;
                width:250px;
            }
        </style>
    </head>
    <body>
        <canvas id="board" width="250" height="550"></canvas>
        <script>

            function arrayCopyBlock(board, piece, y, x) {
                var newBoard = $.extend(true, [], board);
                for (var i = 0; i < piece.length; i++) {
                    for (var g = 0; g < piece[i].length; g++) {
                        newBoard[y + i][x + g] = piece[i][g];
                    }
                }
                return newBoard;
            }

            function printBoard(board) {
                var out = "";
                for (var y = 0; y < board.length; ++y) {
                    for (var x = 0; x < board[y].length; ++x) {
                        out += board[y][x] + " ";
                    }
                    out += "\n";
                }
                console.log(out);    
            }

            function createEmptyBoard(height, width) {
                var board = new Array(height);
                for (var y = 0; y < height; ++y) {
                    board[y] = new Array(width);
                    for (var x = 0; x < width; ++x) {
                        board[y][x] = 0;
                    }
                }
                return board;
            }

            var KEY_LEFT = 37;
            var KEY_RIGHT = 38;
            var KEY_UP = 39;
            var KEY_DOWN = 40;
            
            var GRID_SIZE = 30;
            
            var BOARD_WIDTH = 13;
            var BOARD_HEIGHT = 22;
            
            var EMPTY_CELL = 0;
            var VISIBLE_BOARD_WIDTH = 10;
            var VISIBLE_BOARD_HEIGHT = 20;

            var VISIBLE_BOARD_X_START = 2;
            var VISIBLE_BOARD_X_END = 12;
            
            var VISIBLE_BOARD_Y_START = 2;
            var VISIBLE_BOARD_Y_END = 22; 

            var iPiece = [
                [
                    [0, 0, 0, 0],
                    [0, 0, 0, 0],
                    [1, 1, 1, 1],
                    [0, 0, 0, 0],
                ],
                [
                    [0, 0, 1, 0],
                    [0, 0, 1, 0],
                    [0, 0, 1, 0],
                    [0, 0, 1, 0],
                ]                
            ];

            var iPieceStart = [0, 5];

            var board = createEmptyBoard(BOARD_HEIGHT, BOARD_WIDTH);
            printBoard(board);
            var piecePos = iPieceStart;
            var newBoard = arrayCopyBlock(board, iPiece[0], piecePos[0], piecePos[1]); 
            printBoard(newBoard);


            var piecePos = [0, 0];

            $("body").keydown(function(e){
                if ((e.keyCode || e.which) == KEY_LEFT) {
                    console.log("LEFT");
                    e.preventDefault();                    
                } else if ((e.keyCode || e.which) == KEY_RIGHT) {
                    console.log("RIGHT");
                    e.preventDefault();                    
                } else if ((e.keyCode || e.which) == KEY_UP) {
                    console.log("UP");
                    e.preventDefault();                    
                } else if ((e.keyCode || e.which) == KEY_DOWN) {
                    console.log("DOWN");
                    e.preventDefault();
                }
            });
        </script>
    </body>
</html>        